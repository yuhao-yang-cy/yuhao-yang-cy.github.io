---
layout: post
title: "从勾股数到费马大定理"
date: 2020-11-19 14:07:00
description: 受西蒙·辛格的数学科普《费马大定理》启发，写写费马大定理的故事，然后写写 $$n=4$$ 和 $$n=3$$ 时费马大定理的证明
tags: mathematics number-theory
categories: mathematics
---

> 最近翻完西蒙·辛格的数学科普《费马大定理》，Andrew Wiles 闭关憋惊天大招的故事读得心潮澎湃。趁着还热乎着的三分钟热度，赶紧写点什么可以给高中水平的数学爱好者（差不多也是我自己水平）看的东西。
>
> 我打算从勾股数谈起，写写费马大定理的故事，然后写写 $$n=4$$ 和 $$n=3$$ 时费马大定理的证明（更 general 情况的证明显然远远超出我的能力以外），写到哪里是哪里吧。

## 从勾股数谈起

所谓**勾股数**（Pythagorean triple），指的是符合勾股定理 $$x^2 + y^2 = z^2$$ 的正整数数组 $$(x,y,z)$$。因为任何一组勾股数的整数倍显然也是勾股数，所以一般而言，我们更加关注三者**互质**的数组  $$(x,y,z)$$。这里我们将介绍一种产生勾股数的算法，并将看到互质的勾股数有无穷多组。

将勾股定理稍作改写，可以有

$$
\begin{aligned}
x^2 = z^2 - y^2 &= (z+y)(z-y) \\
\frac{z+y}{x} &= \frac{x}{z-y}
\end{aligned}
$$

令 $$\frac{z+y}{x} = \frac{m}{n}$$，其中 $$m, n$$ 为满足 $$m>n$$ 的正整数。根据改写后的勾股关系，立刻有 $$\frac{z-y}{x} =\frac{n}{m}$$。我们进而可以写出如下关系：

$$
\left\{ \begin{array}{l}
\displaystyle \frac{z}{x} + \frac{y}{x} = \frac{m}{n} \\
\displaystyle \frac{z}{x} - \frac{y}{x} = \frac{n}{m} \\
\end{array} \right.
\quad \Rightarrow \quad
\left\{ \begin{array}{l}
\displaystyle \frac{z}{x} = \frac{1}{2} \left( \frac{m}{n} + \frac{n}{m} \right) = \frac{m^2 + n^2}{2mn}\\
\displaystyle \frac{y}{x} = \frac{1}{2} \left( \frac{m}{n} - \frac{n}{m} \right) = \frac{m^2 - n^2}{2mn} \\
\end{array} \right.
$$

很自然地，选取

$$
\boxed{x= 2mn, \, y=m^2-n^2, \, z=m^2+n^2} \tag{\#}
$$

就会自动满足 $$x^2 + y^2 = z^2$$。

注意到，如此构造出来的 $$x$$ 必为偶数，如果 $$m$$ 和 $$n$$ 同为奇数或者同为偶数，则 $$y$$ 和 $$z$$ 也将是偶数，这样  $$(x,y,z)$$ 将含有公因子 $$2$$，不符合互质的要求。另一方面，如果 $$m$$ 和 $$n$$ 含有公因子 $$p>1$$，那么 $$(x,y,z)$$ 也将含有公因子 $$p$$，也不符合互质的要求。

因此我们可以下结论：要通过 $$(\#)$$ 式生成互质的勾股数 $$(x,y,z)$$，$$m$$ 和 $$n$$ 必须是一个奇偶数对，并且除了1之外它们没有其他公因子。但显然，这样的 $$(m,n)$$ 有无穷多组，因此互质的勾股数也有无穷多组。

举点栗子，一些勾股数的构造如下：

$$
\begin{aligned}
m=2, \,n=1 \quad &\Rightarrow \quad (x,y,z) = (4,3,5) \\
m=3, \,n=2 \quad &\Rightarrow \quad (x,y,z) = (12,5,13) \\
m=4, \,n=1 \quad &\Rightarrow \quad (x,y,z) = (8,15,17) \\
m=4, \,n=3 \quad &\Rightarrow \quad (x,y,z) = (24,7,25) \\
&\cdots
\end{aligned}
$$

## 费马大定理的故事

上面我们看到了，满足 $$x^2 + y^2 = z^2$$ 的互质的正整数 $$(x,y,z)$$ 有无穷多对。然而，如果我们把指数 $$n$$ 替换成任何大于 2 的正整数，方程的解会如何呢？

1637年，法国数学家费马（Pierre de Fermat）在阅读丢番图的著作时，突发灵感写下了如下命题：当正整数 $$n\geq3$$ 时，关于 $$x,y,z$$ 的方程

$$
x^n + y^n = z^n
$$

不存在任何正整数解。此即费马大猜想，350多年后经英国数学家 Andrew Wiles 证明，终于从猜想升级成为了一条定理，现被称为**费马大定理**（Fermat's last theorem）。

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/wiles-last-theorem.jpg" title="费马大定理及它的证明者 Andrew Wiles" class="img-natural rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    费马大定理及它的证明者 Andrew Wiles
</div>


跟费马的猜想同样著名的，是费马在写下猜想同时留下的一段注释。有点恶作剧心思的费马大约是出于挑战同时代的数学家的目的，很皮地留下了数学史上恐怕是最著名的一段注释：“*我相信我找到了一个美妙的证明方法，可惜这里的空白处太小了，我写不下来。*”

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/fermat-margin-note.jpg" title="带有费马注解的丢番图《算术》的拉丁文译本" class="img-natural rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    图为带有费马注解的丢番图《算术》的拉丁文译本。费马拥有的原本已经丢失，费马的儿子在费马去世后将他父亲的原稿整理后出版。图中中下部分那3行半就是费马那句著名的：“这里的空白处太小了，我写不下来。”
</div>

然而，欧拉、热尔曼、高斯、勒让德、法尔廷斯等几代数学大佬，也仅仅只是证明了费马猜想的一些特殊情况，费马猜想在3个半世纪的时间内始终无法被证明，也无法被证伪，成为数论领域中的皇冠上的无人可及的明珠。直到20世纪90年代，**英国数学家 Andrew Wiles 通过近十年的卓绝努力，证明了谷山-志村定理（Taniyama-Shimura theorem），通过将椭圆曲线和模形式建立起对应关系，运用反证法证明了：如果* $$x^n+y^n=z^n$$ *存在正整数解，那么某种椭圆曲线就会是谷山-志村定理的一个反例，所以费马大定理必须成立。**

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/wiles-proof.jpg" title="Andrew Wiles and His Proof" class="img-natural rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    Andrew Wiles 1993年在剑桥作了三场演讲，介绍了他证明费马大定理的伟大工作。在最后一次演讲临近结束时，他宣布证明完成，此后立即引起数学界的轰动。图为 BBC Horizon 纪录片《费马大定理》拍摄时 Andrew Wiles 回忆那极富戏剧性的一幕时的情景。
</div>

在证明谷山-志村定理的过程中，Andrew Wiles 历经坎坷，几乎单枪匹马地在前人工作的基础上创造出了大量全新的数学方法，诸多数学概念在这个过程中孕育而生，这也奠定了 Andrew Wiles 在数学史上比肩那些上古大神的一席之地。

这里大力推荐下西蒙·辛格的《费马大定理》，这本书回顾了从费马大定理诞生到其被证明的精彩故事。全书最令我印象深刻的，是 Andrew Wiles 在异常艰难的探索、黑暗中独自前行之后，在世纪讲座结束时那句“我想我就在这里结束吧”，和在自家书房里搞定全部证明细节后下楼时对妻子说的那句“我想我已经找到它了”，返璞归真的境界令人动容。

利用我们在上篇中介绍的勾股数的构造方法，不难证明 $$n=4$$ 的情况。而 $$n=3$$ 的情况也可以用相对初等的方法给出证明，后面的篇幅就留给具体的证明细节。

## 无穷递降法

费马大定理的最简单的两种情况，即关于 $$x,y,z$$ 的方程 $$x^n+y^n=z^n$$ 在 $$n=4$$ 和 $$n=3$$ 时不存在正整数解，其证明过程对于普通数学爱好者而言还不是那么遥不可及。

我们的论证将基于以下的逻辑：假设我们可以找到某一组正整数解 $$(x,y,z)$$，那么必然存在另一组更小的正整数解 $$(x',y',z')$$，其中 $$z' <z $$。但原方程一定存在最小的正整数解，从而产生矛盾。因此正整数解不存在。

这种反证法的思想被称作**无穷递降法**（proof by infinite descent）。费马本人发展了这套方法，并成功证明了 $$x^4+y^4=z^4$$ 不能存在整数解。欧拉之后利用同样的思想，搞定了 $$n=3$$ 的情况。尽管后来勒让德、狄利克雷、拉梅当、勒贝格等数学家陆续利用无穷递降法证明了 $$n=5, 7$$ 等特别幂次的情况，但随着幂次的增加，构造无穷递降的路数变得越发困难，更普遍情况的证明需要新的数学工具。现在很多人认为，费马声称自己找到了费马大定理的绝妙证明时，他很可能高估了无穷递降法的威力。

不过话说回来，无穷递降法来处理 $$n=4$$ 和 $$n=3$$ 的情况还是异常巧妙的。我们接下来就进入正题。

注：下面的讨论中，出现的所有字母如果没有特别声明，则均代表正整数。

## 两条预备定理

### 1

关于勾股数构造的细节，在文章的前半部分已经给出。这里引用结论：如果互质的正整数 $$x,y,z$$ 满足

$$
x^2 + y^2 = z^2
$$

则它们可以通过如下的方式构造：任取两个互质的奇偶数对 $$m,n$$（设 $$m>n$$），取

$$
\begin{aligned}
x&=2mn \\
y&=m^2-n^2 \\
z&=m^2+n^2
\end{aligned}
$$

不难验证

$$
\begin{aligned}
(2mn)^2 + (m^2-n^2)^2 &= 4m^2n^2 + m^4 - 2m^2n^2 + n^4 \\
&= m^4 + 2m^2n^2 + n^4 \\
&= (m^2+n^2)^2
\end{aligned}
$$

如此得到的 $$(x,y,z)$$ 将构成一组互质的勾股数。

### 2

如果互质的正整数 $$x,y,z$$ 满足

$$
x^2 + 3y^2 = z^3
$$

则它们可以通过如下的方式构造：任取两个互质的奇偶数对 $$m,n$$（依然设 $$m>n$$），取

$$
\begin{aligned}
x &= m(m^2-9n^2) \\
y &= 3n(m^2-n^2) \\
z &= m^2 + 3n^2
\end{aligned}
$$

不难验证

$$
\begin{aligned}
(m^3 - 9mn^2)^2 + 3(3m^2n-3n^3)^2 
&= (m^6 - 18m^4n^2 +81m^2n^4) + 3(9m^4n^2 - 18m^2n^4+9n^6) \\
&= m^6 + 9m^4n^2 + 27m^2n^4 + 27n^6 \\
&= (m^2 + 3n^2)^3
\end{aligned}
$$

如此得到的 $$(x,y,z)$$ 是互质的并且将自动满足 $$x^2 + 3y^2 = z^3$$。

## Fermat's Last Theorem for $$n=4$$

我们先来考察方程：

$$
x^4 + y^4 = z^2
$$

假设它存在最小的正整数解 $$(x,y,z)$$。我们期望通过找出矛盾，推翻假设，从而通过反证法证明这个方程不存在正整数解。

注意到方程可以改写成勾股定理的形式：

$$
(x^2)^2 + (y^2)^2 = z^2
$$

首先，**我们来分析下 $$x,y,z$$ 的奇偶性。**

显然，它们不可能都为奇数，也不可能只有一个奇数，如此一来方程两边必然会有不同的奇偶性，无法成立。

它们也不能全是偶数。若将它们写成 $$x=2a, y=2b$$，则

$$
z^2 = x^4 + y^4 = (2a)^4+(2b)^4 = 16(a^4 + b^4)
$$

这说明 $$z$$ 必然是4的倍数。设 $$z=4c$$，则有 $$a^4+b^4=c^2$$，即 $$(a,b,c)$$ 是满足同样形式方程的更小的正整数解，跟 $$(x,y,z)$$ 是最小的整数解的假定矛盾。

于是 $$x,y,z$$ 必然是两个奇数和一个偶数的组合。如果 $$x,y$$ 都是奇数，$$z$$ 是偶数，由于任何整数与它的平方有相同的奇偶性，可以设 $$x^2=2a+1$$，$$y^2=2b+1$$，$$z=2c$$，则

$$
\begin{aligned}
(x^2)^2 + (y^2)^2 &= 4(a^2 + a+b^2 +b) + 2 \\
z^2 &= 4c^2
\end{aligned}
$$

左边除以4的余数为2，而右边可以被4整除，导致矛盾，所以刚才假定的奇偶性组合也不成立。

因此，**剩下的唯一的可能性，就是 $$z$$ 是奇数，$$x$$ 和 $$y$$ 为一奇一偶的组合。** 不妨设 $$x$$ 为偶数，$$y$$ 为奇数，利用勾股数的构造，我们有：

$$
\begin{aligned}
x^2 &= 2mn  \\ 
y^2 &= m^2-n^2 \\
z &= m^2 + n^2
\end{aligned} \tag{1}
$$

将关于 $$y$$ 的式子稍作改写，变成

$$
n^2 + y^2 = m^2
$$

我们发现 $$(n,y,m)$$ 可以构成一组新的勾股数。

由于 $$y$$ 是奇数，$$n$$ 和 $$m$$ 必须是一奇一偶的组合。如果其中 $$n$$ 为奇数、$$m$$ 为偶数，则利用之前类似的逻辑，会发现 $$n^2+y^2$$ 除以4的余数为2，$$m^2$$ 却是4的倍数，两者不可能相等。所以**只能是 $$n$$ 为偶数，$$m$$ 为奇数。** 再次利用勾股数的构造，我们写出：

$$
\begin{aligned}
n &= 2pq \\
y &= p^2 - q^2 \\
m &= p^2 + q^2
\end{aligned} \tag{2}
$$

将$$(2)$$代入$$(1)$$中关于 $$x$$ 的式子里：

$$
x^2 = 4pq(p^2+q^2)
$$

注意在两次勾股数的构造中，要求 $$m$$ 和 $$n$$ 互质，以及 $$p$$ 和 $$q$$ 互质。结合$$(2)$$式以及 $$m$$、$$n$$ 互质的要求，我们推知 $$pq$$ 与 $$p^2+q^2$$ 互质。但 $$p$$ 和 $$q$$ 两者也是互质的，所以 $$p$$、$$q$$、$$m=p^2+q^2$$ 三者互质。**$$4pq(p^2+q^2)$$ 是一个完全平方意味着 $$p$$、$$q$$、$$m$$ 三者都是完全平方**，即

$$
\begin{aligned}
p=r^2 \\
q=s^2 \\
m=t^2
\end{aligned} \tag{3}
$$

将$$(3)$$式代回$$(2)$$式中的最后一条，我们发现

$$
r^4 + s^4 = t^2
$$

这条方程形式上与我们最初考察的方程一模一样，就是说 $$(r,s,t)$$ 也构成一组原方程的正整数解。但是根据构造，显然 $$t<z $$，这与 $$(x,y,z)$$ 为最小正整数解的假设矛盾。通过无穷递降，总是可以找到更小的正整数解，所以最小正整数解存在的假设不能成立。换言之，方程

$$
x^4 + y^4 = z^2
$$

不存在正整数解。

既然任意两个正整数的4次幂之和不可能是一个完全平方数，那就更加不可能是一个四次方数了。至此我们证明了方程

$$
x^4 + y^4 = z^4
$$

不存在正整数解。

## Fermat's Last Theorem for $$n=3$$

我们来考察方程：

$$
x^3 + y^3 + z^3 = 0
$$

假设它存在一组最小的整数解 $$(x,y,z)$$。如果假设会推出矛盾，也就是说待考察的方程实际上不存在整数解，由于 $$x,y,z$$ 不可能符号全部相同，我们很容易通过移项，得知 $$x^3 + y^3 = z^3$$ 也不可能有正整数解。

**我们还是先来分析下 $$x,y,z$$ 的奇偶性。** 很容易排除三者全为奇数、三者中有且仅有一个奇数的情况，因为这会导致三者的立方和也为奇数，不可能为零。三者全为偶数也是不允许的，因为取 $$a=\frac{1}{2}x,\, b=\frac{1}{2}y, \, c=\frac{1}{2}z$$，立刻有 $$a^3+b^3+c^3=0$$，即 $$(a,b,c)$$ 也是原方程的整数解，但这与 $$(x,y,z)$$ 是最小整数解的假设不符。于是，**$$x,y,z$$ 必然是一个偶数和两个奇数的组合。**

不失普遍性，我们设 $$z$$ 是偶数，可以写作 $$z=2c$$。$$x,y$$ 两者都是奇数。

如果 $$x=y$$，那么有 $$2x^3 = -z^3 = -8c^3$$，或 $$x^3 = -4c^3$$，这说明 $$x$$ 又该是偶数，导致矛盾，所以 $$x\neq y$$。

既然 $$x,y$$ 同为奇数并且不相等，那么它俩的和及差都将是偶数

$$
\begin{aligned}
2a &= x+y \\
2b &= x-y
\end{aligned}
$$

不难从中反解出 $$x$$ 和 $$y$$：

$$
x= a+b, \quad y=a-b
$$

代回到原方程里，我们得到

$$
-z^3 = (a+b)^3 + (a-b)^3 = 2(a^3 + 3ab^2) = 2a(a^2+3b^2) = -8c^3 \tag{4}
$$

注意到 $$x,y$$ 同为奇数要求 $$a$$ 和 $$b$$ 的奇偶性不同。但不论 $$a$$ 和 $$b$$ 中谁是奇数，谁是偶数，$$a^2 + 3b^2$$ 总是奇数。要使 $$2a(a^2+3b^2) = -8c^3$$，**$$a$$ 就必须是4的倍数，因而一定是偶数。$$b$$ 就将是奇数。**

接下来，留意到 $$z^3$$ 含有 $$a^2+3b^2$$ 这个因子，我们可以对 $$a$$ 是或不是 3 的倍数的情况进行分类讨论。

### $$a$$ 不是3的倍数

注意 $$(x,y,z)$$ 是原方程的最小整数解意味着 $$x$$ 和 $$y$$ 互质，因此 $$a$$ 和 $$b$$ 也是一对互质的数。$$a$$ 无法整除3意味着 $$a^2+3b^2$$ 与 $$a$$ 互质。记得 $$a^2 + 3b^2$$ 总是奇数而 $$a$$ 是偶数，所以我们进一步推知 $$2a$$ 与 $$a^2+3b^2$$ 互质。两者的乘积是一个立方数（$$z^3$$）意味着这两者各自都是立方数：

$$
\begin{aligned}
2a & = p^3 \\
a^2 + 3b^2 &= q^3
\end{aligned} \tag{5}
$$

利用先前的预备定理对付$$(5)$$式的第二条，我们可以继续写出

$$
\begin{aligned}
a &= m(m^2-9n^2) \\
b &= 3n(m^2-n^2) \\
q &= m^2 + 3n^2
\end{aligned} \tag{6}
$$

将$$(6)$$式代回$$(5)$$式中的第一条：

$$
p^3 = 2m(m^2-9n^2) = 2m(m-3n)(m+3n)
$$

$$b$$ 是奇数，通过$$(6)$$式的第二条，我们知道 $$n$$ 和 $$m^2-n^2$$ 都是奇数，因此 $$m$$ 必须是偶数，则 $$m\pm3n$$ 一定是奇数。又基于我们现在的假定，$$a$$ 不能被3整除，$$(6)$$式的第一条告诉我们 $$m$$ 也不能被3整除。另外，$$m$$ 和 $$n$$ 互质，这些条件放到一起，意味着 **$$2m$$、$$m-3n$$、$$m+3n$$ 这三者互质。但现在这三者的乘积等于一个立方数（$$p^3$$），只可能它们各自都是一个立方数：**

$$
\begin{aligned}
-2m &= r^3 \\
m-3n &= s^3 \\
m+3n &= t^3 
\end{aligned} \tag{7}
$$

为了方便起见，$$(7)$$式的第一条里多添加了一个负号。但是如果 $$2m$$ 是一个立方数，即 $$2m=r'^3$$，取 $$r=-r'$$，自然有 $$-2m=-r'^3 = r^3$$。耍了点小聪明后，我们把$$(7)$$式的三条通通加到一起，得到：

$$
r^3+s^3+t^3=0
$$

这说明存在满足原方程的更小的一组整数解 $$(r,s,t)$$。

### $$a$$ 是3的倍数

既然 $$a$$ 是3的倍数，就可以被写作 $$a=3k$$。代回$$(4)$$式，得到

$$
-z^3 = 2a(a^2+3b^2) = 6k(9k^2+3b^2) = 18k(3k^2+b^2)
$$

$$a$$ 和 $$b$$ 互质意味着 $$b$$ 不能被3整除，并且 $$b$$ 也与 $$k$$ 互质，因此 $$3k^2+b^2$$ 不能被3整除，并且 $$3k^2 +b^2$$ 与 $$k$$ 是互质的。记得 $$a$$ 是偶数，$$k$$ 也必然为偶数。而 $$b$$ 是一个奇数，因此 $$3k^2+b^2$$ 也是一个奇数，即不能被2整除。注意到 $$18=2\times3^2$$，于是 $$3k^2+b^2$$ 必然无法整除18。所以我们进一步推知 $$18k$$ 与 $$3k^2 + b^2$$ 互质，而两者的乘积是一个立方数（$$z^3$$），它们各自都必须是立方数：

$$
\begin{aligned}
18k & = p^3 \\
b^2 + 3k^2 &= q^3
\end{aligned} \tag{8}
$$

再次利用先前的预备定理对付$$(8)$$式的第二条，我们有

$$
\begin{aligned}
b &= m(m^2-9n^2) \\
k &= 3n(m^2-n^2) \\
q &= m^2 + 3n^2
\end{aligned} \tag{9}
$$

将$$(9)$$式代回$$(8)$$式中的第一条：

$$
p^3 = 54n(m^2-n^2) = 3^3\times2n(m-n)(m+n)
$$

从$$(8)$$式的第一条，很容易看出 $$p$$ 一定能被3整除，所以 $$p^3$$ 必然含有 $$3^3$$ 这个因子。而在$$(9)$$式的构造过程中，我们要求 $$m$$ 和 $$n$$ 互质并且拥有不同的奇偶性，$$m$$、$$n$$ 互质导致 $$n$$、$$m-n$$、$$m+n$$ 三者互质，$$m$$、$$n$$ 奇偶性不同则 $$m \pm n$$ 必为奇数。**因此 $$2n$$、$$m-n$$、$$m+n$$ 三者互质。** 跟之前的论证一样的逻辑，**这三者的乘积等于一个立方数（$$p^3$$），它们必须都各是一个立方数：**

$$
\begin{aligned}-2n &= r^3 \\m-n &= s^3 \\m+n &= t^3 \end{aligned} \tag{10}
$$

$$(10)$$式的第一条出于之前类似的原因悄悄加了一个负号。把$$(10) $$式的三条通通加到一起：

$$
r^3+s^3+t^3=0
$$

这说明存在满足原方程的更小的一组整数解 $$(r,s,t)$$。

综上，不论何种情况，**如果存在一组整数解 $$(x,y,z)$$，总可以更小的一组整数解 $$(r,s,t)$$。根据无穷递降的思想，这与存在最小整数解的假定互相矛盾，因此 $$x^3+y^3+z^3=0$$ 不可能有整数解。**

于是根据早先的讨论，我们证明了，方程

$$
x^3 + y^3 = z^3
$$

不存在任何正整数解。