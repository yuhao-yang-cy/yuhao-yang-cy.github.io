<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Face Recognition (Deep Learning Notes C4W4) | Colin Young's Personal Site </title> <meta name="author" content="Colin Young"> <meta name="description" content="training a Siamese network for face recognition tasks with a triplet loss function"> <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' data: https:; media-src 'self' https:; frame-src 'self' https:; connect-src 'self' https:;"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?v=a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?v=f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?v=62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?v=591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?v=d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://yuhao-yang-cy.github.io//blog/2026/deep-C4W4-face-recognition/"> <script src="/assets/js/theme.js?v=5fea5159b787642c1bbc1f334d60f883"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?v=5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Colin Young's Personal Site </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home </a> </li> <li class="nav-item "> <a class="nav-link" href="/bio/">bio </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">posts </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/books/">bookshelf </a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">logs </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="fa-solid fa-magnifying-glass"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-half-sun-moon" id="light-toggle-system"></i> <i class="fa-solid fa-moon" id="light-toggle-dark"></i> <i class="fa-solid fa-sun" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Face Recognition (Deep Learning Notes C4W4)</h1> <p class="post-meta"> Created on January 05, 2026 </p> <p class="post-tags"> <a href="/blog/2026"> <i class="fa-solid fa-calendar fa-sm"></i> 2026 </a>   ·   <a href="/blog/tag/machine-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> machine-learning</a>   <a href="/blog/tag/deep-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> deep-learning</a>   <a href="/blog/tag/cnn"> <i class="fa-solid fa-hashtag fa-sm"></i> CNN</a>   <a href="/blog/tag/computer-vision"> <i class="fa-solid fa-hashtag fa-sm"></i> computer-vision</a>   ·   <a href="/blog/category/machine-learning"> <i class="fa-solid fa-tag fa-sm"></i> machine-learning</a>   <a href="/blog/category/computer-science"> <i class="fa-solid fa-tag fa-sm"></i> computer-science</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <blockquote> <p>These are some notes for the Coursera Course on <a href="https://www.coursera.org/learn/convolutional-neural-networks" rel="external nofollow noopener" target="_blank">Convolutional Neural Networks</a>, which is a part of the <a href="https://www.coursera.org/specializations/deep-learning" rel="external nofollow noopener" target="_blank">Deep Learning Specialization</a>. This post is a summary of the course contents that I learned from Week 4.</p> <p>These notes are far from original. All credits go to the course instructor Andrew Ng and his team.</p> </blockquote> <h2 id="face-recognition-overview">Face Recognition: Overview</h2> <p>Face recognition technology uses AI to analyze unique facial features, creating a mathematical encoding to identify or verify a person, common in access control systems like contactless entrance guards and phone unlocking (Face ID).</p> <p>Face recognition problems commonly fall into one of the two categories:</p> <ul> <li> <strong>Face Verification</strong> <ul> <li>Input: image, name/ID</li> <li>Output: whether the input image corresponds to the claimed person (1-to-1 matching problem)</li> </ul> </li> <li> <strong>Face Recognition</strong> <ul> <li>Input: image</li> <li>Output: whether the input image corresponds to any one of the registered persons in a database (1-to-\(K\) matching problem)</li> </ul> </li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/deep/C4W4_face_recog_tasks-480.webp 480w,/assets/img/deep/C4W4_face_recog_tasks-800.webp 800w,/assets/img/deep/C4W4_face_recog_tasks-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/deep/C4W4_face_recog_tasks.png" class="img-natural rounded z-depth-1" width="100%" height="auto" title="Face Recognition Tasks" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Face Recognition Tasks </div> <h2 id="one-shot-learning">One-shot Learning</h2> <p>One of the difficulties in this approach is that we might only have one example image for each person to train the model. This is called <strong>one-shot learning</strong>.</p> <p>Also, the model has to be retrained each time a new person is added to the database, and in test time, we need to compare an input image to all the instances in the database.</p> <p>One possible solution for the one-shot learning problem is to learn a <strong>similarity function</strong>:</p> \[d(\text{img1}, \text{img2}) = \text{degree of difference between the input images}\] <ul> <li>If \(d(\text{img1}, \text{img2})\) is less than some threshold value, then we claim the two images show the same person.</li> <li>If \(d(\text{img1}, \text{img2})\) is greater than the threshold, then the two images show two different persons.</li> </ul> <h2 id="siamese-network">Siamese Network</h2> <p>To learn a similarity function, we use a <strong>Siamese Network</strong>, which takes a person’s image \(x\) as the input and outputs an <strong>encoding</strong> \(f(x)\). In the course’s programming assignment, we used a 128-dimensional encoding in the output layer, i.e., the output is a vector of 128 components.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/deep/C4W4_f_x-480.webp 480w,/assets/img/deep/C4W4_f_x-800.webp 800w,/assets/img/deep/C4W4_f_x-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/deep/C4W4_f_x.jpg" class="img-natural rounded z-depth-1" width="100%" height="auto" title="Encoding of a Face Image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Encoding of a Face Image </div> <p>The goal of training is to learn parameters so that</p> <ul> <li>If \(x^{(i)}\) and \(x^{(j)}\) are the same person, then \(\| f(x^{(i)}) - f(x^{(j)}) \|^2\) is small.</li> <li>If \(x^{(i)}\) and \(x^{(j)}\) are different persons, then \(\| f(x^{(i)}) - f(x^{(j)}) \|^2\) is large.</li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/deep/C4W4_siamese-480.webp 480w,/assets/img/deep/C4W4_siamese-800.webp 800w,/assets/img/deep/C4W4_siamese-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/deep/C4W4_siamese.jpg" class="img-natural rounded z-depth-1" width="100%" height="auto" title="Siamese Network for Face Recognition Tasks" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Siamese Network for Face Recognition Tasks </div> <h2 id="triplet-loss">Triplet Loss</h2> <p>The <strong>triplet loss</strong> is an effective loss function for training a neural network to learn an encoding of a face image. In particular, training of the network use triplets of images \((A, P, N)\), that is:</p> <ul> <li> <strong>Anchor</strong> \(A\): an image of a person</li> <li> <strong>Positive</strong> \(P\): an image of the same person as the Anchor</li> <li> <strong>Negative</strong> \(N\): an image of a different person</li> </ul> <p>The network will try to learn parameters that pushes the encodings of \(A\) and \(P\) closer together while pulling the encodings of \(A\) and \(N\) further apart. For even better differentiation, we would like to make sure that the Anchor image \(A\) is closer to the Positive image \(P\) than to the Negative image \(N\) by at least some margin \(\alpha\).</p> \[d(A, P) + \alpha &lt; d(A, N)\] <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/deep/C4W4_triplet-loss-480.webp 480w,/assets/img/deep/C4W4_triplet-loss-800.webp 800w,/assets/img/deep/C4W4_triplet-loss-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/deep/C4W4_triplet-loss.png" class="img-natural rounded z-depth-1" width="100%" height="auto" title="Triplet Loss" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Triplet Loss </div> <p>If we measure the similarity with an \(L_2\) distance, then this becomes</p> \[\| f(A)-f(P)\|^2+\alpha &lt; \| f(A)-f(N)\|^2\] <p>With a training dataset of many triplets, we would like to minimise the following triplet cost:</p> \[\mathcal{J} = \sum^{m}_{i=1} \text{max} \left( \left[ \| f(A^{(i)}) - f(P^{(i)}) \|^2 - \| f(A^{(i)}) - f(N^{(i)}) \|^2 + \alpha \right], 0 \right)\] <p>where \((A^{(i)}, P^{(i)}, N^{(i)})\) denotes the \(i\)-th training example.</p> <h2 id="binary-classification">Binary Classification</h2> <p>An alternative to the triplet loss approach is to formulate the face recognition problem as a binary classification problem. The CNN computes the encodings of two input images \(x^{(i)}\) and \(x^{(j)}\), and use a logistic regression unit to produce an output:</p> \[\hat{y} = \sigma\left( \sum_{k=1}^m \left( w_i | f(x^{(i)})_k - f(x^{(j)})_k| + b \right) \right)\] <ul> <li>\(\hat{y} = 1\) if the two images are of the same person</li> <li>\(\hat{y} = 0\) if the two images are of the same person</li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/deep/C4W4_distance_kiank-480.webp 480w,/assets/img/deep/C4W4_distance_kiank-800.webp 800w,/assets/img/deep/C4W4_distance_kiank-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/deep/C4W4_distance_kiank.jpg" class="img-natural rounded z-depth-1" width="100%" height="auto" title="Binary Classification" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Binary Classification </div> </div> </article> </div> <style>.img-natural{max-width:90%;width:auto!important;height:auto;display:block;margin-left:auto;margin-right:auto}h2{color:var(--global-bg-color);background:var(--global-theme-color);line-height:1.6em;border-radius:3px;padding:2px;display:inline-block}</style> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Colin Young. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?v=a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?v=85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?v=2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?v=c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?v=c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?v=d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?v=a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?v=2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?v=f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?v=a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?v=6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?v=ccc841c459bfc0e64c1c2b5acd10df02"></script> </body> </html>